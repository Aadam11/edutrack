<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Government Dashboard - EduTrack</title>
    <meta name="description" content="Real-time analytics and monitoring dashboard for Kano State education infrastructure.">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    
    <!-- Leaflet for mini map -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-green: #2E8B57;
            --secondary-blue: #1E90FF;
            --dark-green: #1A5F3F;
            --light-green: #E8F5E8;
            --text-dark: #2D3748;
            --text-light: #718096;
            --white: #FFFFFF;
            --gray-50: #F7FAFC;
            --gray-100: #EDF2F7;
            --gray-200: #E2E8F0;
            --gray-300: #CBD5E0;
            --red-500: #e53e3e;
            --orange-500: #dd6b20;
            --yellow-400: #f6e05e;
            --purple-500: #9f7aea;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--gray-50);
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: var(--white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-green);
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--primary-green);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .header-nav {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-dark);
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .nav-link:hover,
        .nav-link.active {
            background: var(--light-green);
            color: var(--primary-green);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem 1rem;
            background: var(--gray-50);
            border-radius: 8px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: var(--primary-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-role {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        /* Main Layout */
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            gap: 2rem;
        }

        .page-header {
            margin-bottom: 1rem;
        }

        .page-title {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: var(--text-light);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .live-indicator {
            width: 8px;
            height: 8px;
            background: var(--primary-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stat-card.reports::before {
            background: var(--primary-green);
        }

        .stat-card.schools::before {
            background: var(--secondary-blue);
        }

        .stat-card.resolved::before {
            background: var(--orange-500);
        }

        .stat-card.pending::before {
            background: var(--red-500);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .stat-title {
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stat-icon {
            font-size: 1.5rem;
            opacity: 0.7;
        }

        .stat-value {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive {
            color: var(--primary-green);
        }

        .stat-change.negative {
            color: var(--red-500);
        }

        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: var(--white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
        }

        .chart-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .chart-filter {
            display: flex;
            gap: 0.5rem;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--gray-300);
            background: var(--white);
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        .chart-container {
            height: 300px;
            position: relative;
        }

        /* Recent Reports */
        .recent-reports {
            background: var(--white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
        }

        .section-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .view-all-btn {
            color: var(--primary-green);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s ease;
        }

        .view-all-btn:hover {
            color: var(--dark-green);
        }

        .reports-table {
            width: 100%;
            border-collapse: collapse;
        }

        .reports-table th,
        .reports-table td {
            text-align: left;
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .reports-table th {
            color: var(--text-light);
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .report-row {
            transition: background-color 0.3s ease;
        }

        .report-row:hover {
            background: var(--gray-50);
        }

        .report-id {
            font-family: monospace;
            font-weight: 600;
            color: var(--primary-green);
        }

        .school-name {
            font-weight: 500;
        }

        .report-type {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .type-infrastructure {
            background: rgba(46, 139, 87, 0.1);
            color: var(--primary-green);
        }

        .type-sanitation {
            background: rgba(30, 144, 255, 0.1);
            color: var(--secondary-blue);
        }

        .type-safety {
            background: rgba(229, 62, 62, 0.1);
            color: var(--red-500);
        }

        .type-utilities {
            background: rgba(221, 107, 32, 0.1);
            color: var(--orange-500);
        }

        .priority-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .priority-high {
            background: rgba(229, 62, 62, 0.1);
            color: var(--red-500);
        }

        .priority-medium {
            background: rgba(221, 107, 32, 0.1);
            color: var(--orange-500);
        }

        .priority-low {
            background: rgba(46, 139, 87, 0.1);
            color: var(--primary-green);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-pending {
            background: rgba(221, 107, 32, 0.1);
            color: var(--orange-500);
        }

        .status-in-progress {
            background: rgba(30, 144, 255, 0.1);
            color: var(--secondary-blue);
        }

        .status-resolved {
            background: rgba(46, 139, 87, 0.1);
            color: var(--primary-green);
        }

        .time-ago {
            color: var(--text-light);
            font-size: 0.85rem;
        }

        /* Map and Quick Actions */
        .bottom-section {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
        }

        .map-card {
            background: var(--white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .mini-map {
            height: 400px;
            border-radius: 8px;
            overflow: hidden;
        }

        .quick-actions {
            background: var(--white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 100%;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid var(--gray-200);
            background: var(--white);
            border-radius: 8px;
            text-decoration: none;
            color: var(--text-dark);
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            border-color: var(--primary-green);
            background: var(--light-green);
        }

        .action-icon {
            width: 40px;
            height: 40px;
            background: var(--gray-100);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .action-info {
            flex: 1;
        }

        .action-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .action-description {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .charts-section {
                grid-template-columns: 1fr;
            }

            .bottom-section {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                padding: 1rem;
                flex-wrap: wrap;
                gap: 1rem;
            }

            .header-nav {
                order: 3;
                width: 100%;
                justify-content: center;
                padding-top: 1rem;
                border-top: 1px solid var(--gray-200);
            }

            .user-profile {
                order: 2;
            }

            .dashboard-container {
                padding: 1rem;
            }

            .page-title {
                font-size: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .chart-card {
                padding: 1rem;
            }

            .reports-table {
                font-size: 0.85rem;
            }

            .reports-table th,
            .reports-table td {
                padding: 0.75rem 0.5rem;
            }

            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header-nav {
                flex-wrap: wrap;
                gap: 1rem;
            }

            .chart-filter {
                flex-wrap: wrap;
            }

            .reports-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* Loading States */
        .loading-skeleton {
            background: linear-gradient(90deg, var(--gray-200) 25%, var(--gray-100) 50%, var(--gray-200) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-text {
            height: 1rem;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }

        .skeleton-title {
            height: 1.5rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            width: 60%;
        }

        /* Notification Toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-green);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 10000;
            animation: slideInRight 0.3s ease;
            max-width: 300px;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="index.html" class="logo">
                <div class="logo-icon">📚</div>
                EduTrack
            </a>
            
            <nav class="header-nav">
                <a href="dashboard.html" class="nav-link active">Dashboard</a>
                <a href="map.html" class="nav-link">Map View</a>
                <a href="reports.html" class="nav-link">Reports</a>
                <a href="schools.html" class="nav-link">Schools</a>
                <a href="analytics.html" class="nav-link">Analytics</a>
            </nav>
            
            <div class="user-profile">
                <div class="user-avatar">MK</div>
                <div class="user-info">
                    <div class="user-name">Maryam Kano</div>
                    <div class="user-role">Education Officer</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Dashboard Container -->
    <div class="dashboard-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">Government Dashboard</h1>
            <p class="page-subtitle">
                <span class="live-indicator"></span>
                Real-time education infrastructure monitoring for Kano State
            </p>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card reports">
                <div class="stat-header">
                    <span class="stat-title">Total Reports</span>
                    <span class="stat-icon">📊</span>
                </div>
                <div class="stat-value" id="totalReports">1,247</div>
                <div class="stat-change positive">
                    +12% <span>from last month</span>
                </div>
            </div>

            <div class="stat-card schools">
                <div class="stat-header">
                    <span class="stat-title">Schools Monitored</span>
                    <span class="stat-icon">🏫</span>
                </div>
                <div class="stat-value" id="schoolsMonitored">3,200</div>
                <div class="stat-change positive">
                    +8 <span>new registrations</span>
                </div>
            </div>

            <div class="stat-card resolved">
                <div class="stat-header">
                    <span class="stat-title">Issues Resolved</span>
                    <span class="stat-icon">✅</span>
                </div>
                <div class="stat-value" id="issuesResolved">892</div>
                <div class="stat-change positive">
                    +24% <span>resolution rate</span>
                </div>
            </div>

            <div class="stat-card pending">
                <div class="stat-header">
                    <span class="stat-title">Pending Action</span>
                    <span class="stat-icon">⏱️</span>
                </div>
                <div class="stat-value" id="pendingIssues">355</div>
                <div class="stat-change negative">
                    -8% <span>from last week</span>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-section">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Reports Trend</h3>
                    <div class="chart-filter">
                        <button class="filter-btn active" data-period="7d">7 Days</button>
                        <button class="filter-btn" data-period="30d">30 Days</button>
                        <button class="filter-btn" data-period="90d">3 Months</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="reportsChart"></canvas>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Issue Types</h3>
                </div>
                <div class="chart-container">
                    <canvas id="issueTypesChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Recent Reports -->
        <div class="recent-reports">
            <div class="section-header">
                <h3 class="section-title">Recent Reports</h3>
                <a href="reports.html" class="view-all-btn">View All →</a>
            </div>

            <div style="overflow-x: auto;">
                <table class="reports-table">
                    <thead>
                        <tr>
                            <th>Report ID</th>
                            <th>School Name</th>
                            <th>Issue Type</th>
                            <th>Priority</th>
                            <th>Status</th>
                            <th>Submitted</th>
                        </tr>
                    </thead>
                    <tbody id="reportsTableBody">
                        <tr class="report-row">
                            <td><span class="report-id">EDT-2024-001247</span></td>
                            <td><span class="school-name">Government Day Secondary School Fagge</span></td>
                            <td><span class="report-type type-infrastructure">Infrastructure</span></td>
                            <td><span class="priority-badge priority-high">High</span></td>
                            <td><span class="status-badge status-pending">Pending</span></td>
                            <td><span class="time-ago">2 hours ago</span></td>
                        </tr>
                        <tr class="report-row">
                            <td><span class="report-id">EDT-2024-001246</span></td>
                            <td><span class="school-name">LEA Primary School Kano Municipal</span></td>
                            <td><span class="report-type type-sanitation">Sanitation</span></td>
                            <td><span class="priority-badge priority-medium">Medium</span></td>
                            <td><span class="status-badge status-in-progress">In Progress</span></td>
                            <td><span class="time-ago">4 hours ago</span></td>
                        </tr>
                        <tr class="report-row">
                            <td><span class="report-id">EDT-2024-001245</span></td>
                            <td><span class="school-name">Government Girls Science School Gwale</span></td>
                            <td><span class="report-type type-safety">Safety</span></td>
                            <td><span class="priority-badge priority-high">High</span></td>
                            <td><span class="status-badge status-resolved">Resolved</span></td>
                            <td><span class="time-ago">1 day ago</span></td>
                        </tr>
                        <tr class="report-row">
                            <td><span class="report-id">EDT-2024-001244</span></td>
                            <td><span class="school-name">Government Primary School Dala</span></td>
                            <td><span class="report-type type-utilities">Utilities</span></td>
                            <td><span class="priority-badge priority-low">Low</span></td>
                            <td><span class="status-badge status-in-progress">In Progress</span></td>
                            <td><span class="time-ago">1 day ago</span></td>
                        </tr>
                        <tr class="report-row">
                            <td><span class="report-id">EDT-2024-001243</span></td>
                            <td><span class="school-name">Islamic Secondary School Tarauni</span></td>
                            <td><span class="report-type type-infrastructure">Infrastructure</span></td>
                            <td><span class="priority-badge priority-medium">Medium</span></td>
                            <td><span class="status-badge status-pending">Pending</span></td>
                            <td><span class="time-ago">2 days ago</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Bottom Section: Map and Quick Actions -->
        <div class="bottom-section">
            <div class="map-card">
                <div class="section-header">
                    <h3 class="section-title">School Reports Map</h3>
                    <a href="map.html" class="view-all-btn">Full Map →</a>
                </div>
                <div class="mini-map" id="miniMap"></div>
            </div>

            <div class="quick-actions">
                <div class="section-header">
                    <h3 class="section-title">Quick Actions</h3>
                </div>

                <a href="report.html" class="action-btn">
                    <div class="action-icon">📝</div>
                    <div class="action-info">
                        <div class="action-title">New Report</div>
                        <div class="action-description">Submit new issue report</div>
                    </div>
                </a>

                <a href="reports.html?filter=pending" class="action-btn">
                    <div class="action-icon">⏰</div>
                    <div class="action-info">
                        <div class="action-title">Review Pending</div>
                        <div class="action-description">355 reports awaiting action</div>
                    </div>
                </a>

                <a href="schools.html" class="action-btn">
                    <div class="action-icon">🏫</div>
                    <div class="action-info">
                        <div class="action-title">Manage Schools</div>
                        <div class="action-description">Update school information</div>
                    </div>
                </a>

                <a href="analytics.html" class="action-btn">
                    <div class="action-icon">📈</div>
                    <div class="action-info">
                        <div class="action-title">Generate Reports</div>
                        <div class="action-description">Export data and analytics</div>
                    </div>
                </a>

                <a href="settings.html" class="action-btn">
                    <div class="action-icon">⚙️</div>
                    <div class="action-info">
                        <div class="action-title">Settings</div>
                        <div class="action-description">Configure system settings</div>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let reportsChart, issueTypesChart, miniMap;
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            initializeMiniMap();
            setupEventListeners();
            startRealTimeUpdates();
            showWelcomeMessage();
        });

        // Initialize charts
        function initializeCharts() {
            // Reports Trend Chart
            const reportsCtx = document.getElementById('reportsChart').getContext('2d');
            reportsChart = new Chart(reportsCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'New Reports',
                        data: [12, 19, 15, 25, 22, 18, 24],
                        borderColor: '#2E8B57',
                        backgroundColor: 'rgba(46, 139, 87, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Resolved',
                        data: [8, 12, 18, 20, 15, 22, 19],
                        borderColor: '#1E90FF',
                        backgroundColor: 'rgba(30, 144, 255, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#E2E8F0'
                            }
                        },
                        x: {
                            grid: {
                                color: '#E2E8F0'
                            }
                        }
                    }
                }
            });

            // Issue Types Chart
            const issueTypesCtx = document.getElementById('issueTypesChart').getContext('2d');
            issueTypesChart = new Chart(issueTypesCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Infrastructure', 'Sanitation', 'Safety', 'Utilities', 'Learning Materials'],
                    datasets: [{
                        data: [35, 25, 20, 15, 5],
                        backgroundColor: [
                            '#2E8B57',
                            '#1E90FF',
                            '#e53e3e',
                            '#dd6b20',
                            '#9f7aea'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
        }

        // Initialize mini map
        function initializeMiniMap() {
            miniMap = L.map('miniMap').setView([11.9974, 8.5206], 9);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(miniMap);

            // Add sample markers
            const sampleReports = [
                { lat: 12.0022, lng: 8.5920, type: 'high', title: 'Gov. Day Secondary School Fagge' },
                { lat: 11.9845, lng: 8.5456, type: 'medium', title: 'LEA Primary School Kano Municipal' },
                { lat: 12.0156, lng: 8.4889, type: 'low', title: 'Gov. Girls Science School Gwale' },
                { lat: 11.9678, lng: 8.6234, type: 'medium', title: 'Gov. Primary School Dala' }
            ];

            sampleReports.forEach(report => {
                const color = report.type === 'high' ? '#e53e3e' : 
                            report.type === 'medium' ? '#dd6b20' : '#2E8B57';
                
                L.circleMarker([report.lat, report.lng], {
                    radius: 8,
                    fillColor: color,
                    color: '#fff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(miniMap).bindPopup(report.title);
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Chart filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateReportsChart(this.dataset.period);
                });
            });

            // Real-time updates toggle
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'r') {
                    e.preventDefault();
                    refreshDashboard();
                }
            });
        }

        // Update reports chart based on period
        function updateReportsChart(period) {
            let newData, newLabels;
            
            switch(period) {
                case '7d':
                    newLabels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                    newData = [
                        [12, 19, 15, 25, 22, 18, 24],
                        [8, 12, 18, 20, 15, 22, 19]
                    ];
                    break;
                case '30d':
                    newLabels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
                    newData = [
                        [85, 92, 78, 95],
                        [68, 75, 82, 79]
                    ];
                    break;
                case '90d':
                    newLabels = ['Month 1', 'Month 2', 'Month 3'];
                    newData = [
                        [350, 420, 385],
                        [290, 340, 315]
                    ];
                    break;
            }
            
            reportsChart.data.labels = newLabels;
            reportsChart.data.datasets[0].data = newData[0];
            reportsChart.data.datasets[1].data = newData[1];
            reportsChart.update('active');
        }

        // Start real-time updates
        function startRealTimeUpdates() {
            // Update stats every 30 seconds
            setInterval(updateStats, 30000);
            
            // Update recent reports every 60 seconds
            setInterval(updateRecentReports, 60000);
            
            // Simulate new report notifications
            setTimeout(simulateNewReport, 10000);
        }

        // Update statistics with animation
        function updateStats() {
            const stats = {
                totalReports: Math.floor(Math.random() * 5) + 1245,
                schoolsMonitored: 3200 + Math.floor(Math.random() * 3),
                issuesResolved: 892 + Math.floor(Math.random() * 8),
                pendingIssues: 355 - Math.floor(Math.random() * 5)
            };

            Object.keys(stats).forEach(key => {
                animateCounter(key, stats[key]);
            });
        }

        // Animate counter values
        function animateCounter(elementId, newValue) {
            const element = document.getElementById(elementId);
            const currentValue = parseInt(element.textContent.replace(/,/g, ''));
            
            if (currentValue !== newValue) {
                const increment = newValue > currentValue ? 1 : -1;
                const duration = 1000;
                const steps = Math.abs(newValue - currentValue);
                const stepDuration = duration / steps;
                
                let current = currentValue;
                const timer = setInterval(() => {
                    current += increment;
                    element.textContent = current.toLocaleString();
                    
                    if (current === newValue) {
                        clearInterval(timer);
                    }
                }, stepDuration);
            }
        }

        // Update recent reports table
        function updateRecentReports() {
            const tableBody = document.getElementById('reportsTableBody');
            const reports = generateSampleReports(5);
            
            // Add fade effect
            tableBody.style.opacity = '0.7';
            
            setTimeout(() => {
                tableBody.innerHTML = reports.map(report => `
                    <tr class="report-row">
                        <td><span class="report-id">${report.id}</span></td>
                        <td><span class="school-name">${report.school}</span></td>
                        <td><span class="report-type type-${report.type}">${report.typeLabel}</span></td>
                        <td><span class="priority-badge priority-${report.priority}">${report.priorityLabel}</span></td>
                        <td><span class="status-badge status-${report.status}">${report.statusLabel}</span></td>
                        <td><span class="time-ago">${report.time}</span></td>
                    </tr>
                `).join('');
                
                tableBody.style.opacity = '1';
            }, 300);
        }

        // Generate sample reports
        function generateSampleReports(count) {
            const schools = [
                'Government Day Secondary School Fagge',
                'LEA Primary School Kano Municipal', 
                'Government Girls Science School Gwale',
                'Government Primary School Dala',
                'Islamic Secondary School Tarauni',
                'Government Technical College Nassarawa',
                'LEA Primary School Ungogo',
                'Government Day Secondary School Gwale'
            ];

            const types = [
                { key: 'infrastructure', label: 'Infrastructure' },
                { key: 'sanitation', label: 'Sanitation' },
                { key: 'safety', label: 'Safety' },
                { key: 'utilities', label: 'Utilities' }
            ];

            const priorities = [
                { key: 'high', label: 'High' },
                { key: 'medium', label: 'Medium' },
                { key: 'low', label: 'Low' }
            ];

            const statuses = [
                { key: 'pending', label: 'Pending' },
                { key: 'in-progress', label: 'In Progress' },
                { key: 'resolved', label: 'Resolved' }
            ];

            const times = ['2 hours ago', '4 hours ago', '1 day ago', '2 days ago', '3 days ago'];

            const reports = [];
            for (let i = 0; i < count; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                const priority = priorities[Math.floor(Math.random() * priorities.length)];
                const status = statuses[Math.floor(Math.random() * statuses.length)];
                
                reports.push({
                    id: `EDT-2024-${String(1247 - i).padStart(6, '0')}`,
                    school: schools[Math.floor(Math.random() * schools.length)],
                    type: type.key,
                    typeLabel: type.label,
                    priority: priority.key,
                    priorityLabel: priority.label,
                    status: status.key,
                    statusLabel: status.label,
                    time: times[i] || `${i + 1} days ago`
                });
            }
            
            return reports;
        }

        // Simulate new report notification
        function simulateNewReport() {
            showToast('🆕 New report received: EDT-2024-001248', 'success');
            
            // Update total reports counter
            const totalReportsEl = document.getElementById('totalReports');
            const currentValue = parseInt(totalReportsEl.textContent.replace(/,/g, ''));
            animateCounter('totalReports', currentValue + 1);
            
            // Schedule next notification
            setTimeout(simulateNewReport, Math.random() * 60000 + 30000); // 30-90 seconds
        }

        // Refresh entire dashboard
        function refreshDashboard() {
            showToast('🔄 Dashboard refreshed', 'info');
            
            // Show loading state briefly
            document.querySelectorAll('.stat-value').forEach(el => {
                el.style.opacity = '0.5';
            });
            
            setTimeout(() => {
                updateStats();
                updateRecentReports();
                
                document.querySelectorAll('.stat-value').forEach(el => {
                    el.style.opacity = '1';
                });
            }, 500);
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            const colors = {
                success: '#2E8B57',
                error: '#e53e3e',
                warning: '#dd6b20',
                info: '#1E90FF'
            };
            
            toast.style.background = colors[type] || colors.success;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        // Show welcome message
        function showWelcomeMessage() {
            setTimeout(() => {
                showToast('Welcome to EduTrack Dashboard! 📊 Monitoring 3,200+ schools in real-time.', 'info');
            }, 1000);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.altKey) {
                switch(e.key) {
                    case '1':
                        e.preventDefault();
                        window.location.href = 'dashboard.html';
                        break;
                    case '2':
                        e.preventDefault();
                        window.location.href = 'map.html';
                        break;
                    case '3':
                        e.preventDefault();
                        window.location.href = 'reports.html';
                        break;
                    case 'n':
                        e.preventDefault();
                        window.location.href = 'report.html';
                        break;
                }
            }
        });

        // Export functions for global access
        window.EduTrackDashboard = {
            updateStats,
            refreshDashboard,
            showToast,
            updateReportsChart,
            generateSampleReports
        };

        // Service Worker for offline functionality
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => {
                    console.log('SW registered:', registration);
                })
                .catch(error => {
                    console.log('SW registration failed:', error);
                });
        }

        // Handle online/offline status
        window.addEventListener('online', () => {
            showToast('🌐 Back online! Dashboard data updated.', 'success');
            refreshDashboard();
        });

        window.addEventListener('offline', () => {
            showToast('📱 You\'re offline. Showing cached data.', 'warning');
        });

        console.log('🚀 EduTrack Dashboard Initialized');
        console.log('📊 Real-time monitoring active');
        console.log('⌨️ Keyboard shortcuts: Alt+1 (Dashboard), Alt+2 (Map), Alt+3 (Reports), Alt+N (New Report)');
    </script>

    <style>
        /* Add slideOutRight animation */
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* Enhance mobile responsiveness for charts */
        @media (max-width: 480px) {
            .chart-container {
                height: 200px;
            }
        }

        /* Add hover effects for interactivity */
        .stat-card:hover {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .report-row:hover {
            cursor: pointer;
        }

        /* Loading animation for async content */
        .chart-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--text-light);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--gray-200);
            border-top: 4px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced accessibility */
        .stat-card:focus,
        .action-btn:focus,
        .nav-link:focus {
            outline: 2px solid var(--primary-green);
            outline-offset: 2px;
        }

        /* Print styles */
        @media print {
            .header,
            .quick-actions,
            .mini-map {
                display: none;
            }
            
            .dashboard-container {
                padding: 0;
                max-width: none;
            }
            
            .chart-container {
                height: 300px;
            }
        }
    </style>
</body>
</html>